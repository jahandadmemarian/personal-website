function Clouder(t){var n,e,o,a,i,r,s,l,c,f,h,u,d=0,p=0,v=null,g=null,M=[1],y=8,x=.9,m=.9,b=50,w=.08722,z=.2,I=.025,S=.4,P=[];function C(t){var l,c;t||(t=document.getElementById("right-sidebar").event);l=t.clientX,c=t.clientY,l=2*(o=l-s.offsetLeft)/n-1,l=(Math.abs(l)<I?0:(l-I*X(l))/(1-I))/x,c=2*(a=c-s.offsetTop)/e-1,c=(Math.abs(c)<I?0:(c-I*X(c))/(1-I))/m,p=Math.atan2(c,l),d=Math.sqrt(l*l+c*c),F(q(t.clientX-r,t.clientY-i))}function T(t){t||(t=document.getElementById("right-sidebar").event);d=z,F(null)}function X(t){return t>0?1:t<0?-1:0}function k(){var t="object"==typeof document.body.filters;E(function(o){if(!o.span){o.span=document.createElement("span"),o.width=0,o.height=0,o.span.innerHTML=o.text,o.span.style.fontWeight="bold",o.span.style.position="absolute",o.span.style.cursor="pointer";var a=1;for(var i in f)a=256*a+Math.floor((f[i]-h[i])*o.weight+h[i]);o.span.style.color="#"+a.toString(16).substr(1),s.appendChild(o.span),o.span.descriptor=o}var r=l+o.z*c;o.factor=r/l,0==o.width&&(o.width=asPixels(o.span.clientWidth/o.factor),o.height=asPixels(o.span.clientHeight/o.factor)),o.span.style.fontSize=asPixels(Math.round(r)),o.screenX=n*(o.x*x+1)/2,o.span.style.left=asPixels(o.screenX-parseInt(o.width)*o.factor/2),o.screenY=e*(o.y*m+1)/2,o.span.style.top=asPixels(o.screenY-parseInt(o.height)*o.factor/2),o.span.style.zIndex=o.z>=0?10:5;var u=(Math.sin(o.z*Math.PI/2)/2+.5)*(1-S)+S;if(t){var d=o.span.filters["DXImageTransform.Microsoft.Alpha"];d?d.opacity=100*u:o.span.style.filter+="progid:DXImageTransform.Microsoft.Alpha(opacity="+100*u+")"}else o.span.style.opacity=u})}function q(t,o){var a=n+e,i=null;for(var r in P){var s=P[r],l=t-s.screenX,c=o-s.screenY,f=Math.sqrt(l*l+c*c)/s.factor;f<a&&(a=f,i=s)}return i}function F(t){g!=t&&(null!=g&&(g.span.style.border=""),null!=(g=t)&&(g.span.style.border="0px solid black"))}function Y(){var t=(new Date).getTime();E(function(t){A(t,-p),B(t,d*w),A(t,p)}),function(){for(var t in P){var n=0,e=0,o=0,a=P[t];for(var i in P)if(t!=i){var r=a.x-P[i].x,s=a.y-P[i].y,l=a.z-P[i].z,c=Math.sqrt(r*r+s*s+l*l);n+=.05/(c*c)*r/c,e+=.05/(c*c)*s/c,o+=.05/(c*c)*l/c}a.x+=n,a.y+=e,a.z+=o;var f=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=f,a.y/=f,a.z/=f}}(),k(),F(q(o,a)),M.push((new Date).getTime()-t),M.length>y&&M.splice(0,M.length-y)}function A(t,n){var e=t.x,o=t.y;t.x=e*Math.cos(n)-o*Math.sin(n),t.y=e*Math.sin(n)+o*Math.cos(n)}function B(t,n){var e=t.x,o=t.z;t.x=e*Math.cos(n)-o*Math.sin(n),t.z=e*Math.sin(n)+o*Math.cos(n)}function D(t){null!=g&&g.id}function E(t){for(var n in P)t(P[n])}function H(t){var n=parseInt(t.substr(1),16);return[Math.floor(n/65536),Math.floor(n/256%256),Math.floor(n%256)]}this.getRenderingTime=function(){var t=0;for(var n in M)t+=M[n];return t/M.length},this.kill=function(){clearInterval(v),E(function(t){t.span.parentNode.removeChild(t.span)})},function(t){if(!t.container)throw alert("Clouder could not be created without container!"),"Clouder without container";if(s=t.container,!t.tags&&s.children.length<0)throw alert("Clouder could not be crated without tags or spans in container!"),"Clouder without tags";t.callback?t.callback:function(t){alert(t)},l=t.fontSize?t.fontSize:14,c=void 0!==t.fontShift?t.fontShift:l/2,f=t.colorMax?H(t.colorMax):H("#000000"),h=t.colorMin?H(t.colorMin):H("#FFFFFF"),u=t.colorBgr?t.colorBgr:null,b=void 0!==t.interval?t.interval:b,w=void 0!==t.stepAngle?t.stepAngle:w,z=void 0!==t.idleMotion?t.idleMotion:z,S=void 0!==t.opaque?t.opaque:S,I=void 0!==t.nonSense?t.nonSense:I,void 0!==t.scale&&(x=m=t.scale),x=void 0!==t.xScale?t.xScale:x,m=void 0!==t.yScale?t.yScale:m}(t),t.tags?function(t){if(t)for(var n in t){var e={};e.text=t[n].text,e.id=t[n].id,e.weight=t[n].weight,P.push(e)}}(t.tags):function(){for(var t=0;t<s.children.length;t++){var n=s.children[t];n.style.position="absolute",n.style.cursor="pointer";var e={};e.span=n,e.width=0,e.height=0,P.push(e)}}(),E(function(t){t.x=1,t.y=0,t.z=0,A(t,(2*Math.random()-1)*Math.PI),B(t,(2*Math.random()-1)*Math.PI),A(t,(2*Math.random()-1)*Math.PI)}),n=s.clientWidth,e=s.clientHeight,u&&(s.style.backgroundColor=u),k(),v=setInterval(Y,b),i=s.offsetTop,r=s.offsetLeft,s.onmousemove=C,s.onmouseleave=T,s.onclick=D}function asPixels(t){return t+"px"}